<!DOCTYPE html>
<html>
<head>
  <title>Copy Multiline Variable Text to Clipboard</title>
</head>
<body>
  <button onclick="copyMultilineText1()">p1-P.S Data Read</button>
  <button onclick="copyMultilineText2()">p2-P.S Combine</button>
  <button onclick="copyMultilineText3()">p3-col,filter,mapred P.S</button>
  <button onclick="copyMultilineText4()">p4-spark config df create</button>
  <button onclick="copyMultilineText5()">p5-tempview df sql</button>
  <button onclick="copyMultilineText6()">p6-UDF SS</button>
  <button onclick="copyMultilineText7()">p7-MLIB Linear reg </button>
  <button onclick="copyMultilineText8()">p8-MLIB KMCLUS</button>
  <button onclick="copyMultilineText9()">p9-MLIB LOG Res</button>
  <button onclick="copyMultilineText10()">p10-MLIB Naive</button>
  <button onclick="copyMultilineText11()">p11-word count</button>
  <button onclick="copyMultilineText12()">p12-word count data mal</button>
    
  <script>
    function copyMultilineText1() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `
      
!pip install pyspark
from pyspark.sql import SparkSession
from pyspark.sql.functions import * #

#Step Create Objetct

spark = SparkSession.builder.appName('test').getOrCreate()
df = spark.read.option('header', True).csv('/content/employees.csv')
df.show()

df.select('salary').show(5)
df.printSchema() 

panda_df = df.toPandas()
panda_df.head()

      
      `;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
    function copyMultilineText2() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `
      
from pyspark.sql import SparkSession
from pyspark.sql.functions import *

spark = SparkSession.builder.appName('CombineDataframe').getOrCreate()

data1 = [(1, 'Surabhi', 22), (2, 'Glory', 23), (3, 'Sohel', 5)]
data2 = [(4,'Mitali', 50), (5, 'Siddhi', 24), (6, 'Mangesh', 21)]

columns = ['ID', 'Name', 'Age']

df1 = spark.createDataFrame(data1, columns)
df2 = spark.createDataFrame(data2, columns)

df1.show()
df2.show()

combine_df = df1.union(df2)
combine_df.show()

df3 = df2.select('ID', 'Name','Age')
df3.show()

data4 =[(1, 'Mumbai'), (2, 'Banglore'), (3, 'Delhi'), (4, 'Orissa'), (5, 'Maurities'), (3, 'Andrapradesh')]

columns4 = ['ID', 'City']

df4 = spark.createDataFrame(data4, columns4)
df4.show()

join_df = combine_df.join(df4, on='ID', how='inner')
join_df.show()

     
      `;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
     function copyMultilineText3() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `

from pyspark.sql import SparkSession
from pyspark.sql.functions import col

spark = SparkSession.builder.appName('ecommerce').getOrCreate()
data = [
    ("Alice", 25, "HR"),
    ("Bob", 30, "IT"),
    ("Charlie", 35, "Finance"),
    ("David", 28, "IT"),
    ("Eve", 40, "HR")
]

columns = ["Name", "Age", "Department"]

df = spark.createDataFrame(data, columns)
df.show()

collected_data = df.collect()
for row in collected_data:
  print(row)

filtered_df = df.filter(col("Age") > 30)
filtered_df.show()

mapped_rdd = df.rdd.map(lambda row: (row["Name"], row["Age"] * 2))
mapped_rdd.collect()

rdd = df.rdd.map(lambda row: (row["Department"], 1))
department_count = rdd.reduceByKey(lambda a, b: a + b)
department_count.collect()


      
      `;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
    function copyMultilineText4() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `

from pyspark.sql import SparkSession,Row
#create spark session with configuration
spark = SparkSession.builder.appName('Spark Session Example') \
  .config("sparkconfig","config-value").getOrCreate()

data = [Row(name="surabhi",age=24),Row(name="glory",age=22),Row(name="mitali",age=23)]
df = spark.createDataFrame(data)
df.show()
df.printSchema()

#second method user input
from pyspark.sql import SparkSession
spark = SparkSession.builder.appName('Spark Session Example').getOrCreate()
num_rows = int(input("num of rows:"))
data = []
for i in range (num_rows):
  name = input("Enter name:")
  age = int(input("Enter age:"))
  city = input("Enter city:")
  data.append((name,age,city))

column = ['name','age','city']
df = spark.createDataFrame(data,column)
df.show()
df.printSchema()

print(" Original data ")
df.select("name","age").show()
print(" Age Filter ")
df.filter(df.age>22).show()
print(" where filter ")
df.where(df.city=="mumbai").show()
      
      `;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
    function copyMultilineText5() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `

from pyspark.sql import SparkSession
data  = [(1,'electronics',1000,'2024-01-01'),
         (2,'fashion',50,'2024-01-02'),
         (3,'cosmetics',500,'2024-01-03'),
         (4,'novels',1500,'2025-04-04'),(5,)]
columns = ['id','category','price','date']
spark = SparkSession.builder.appName('ecommerce').getOrCreate()
df = spark.createDataFrame(data,columns)
df.show()

df.createOrReplaceTempView("sales")
result = spark.sql("SELECT category, avg(price) as avg_amt from sales group by category").show()

result = spark.sql("select category, price from sales order by price desc limit 2")
result.show()

import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd

# Convert the DataFrame to Pandas
df_q1 = result.toPandas()
df_q1.head()
plt.figure(figsize=(8, 6))
sns.barplot(x='category', y='price', data=df_q1)
plt.title('Top 2 Categories by Price')
plt.xlabel('Category')
plt.ylabel('Price')
plt.show()


`;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
    function copyMultilineText6() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `

from pyspark.sql import SparkSession
from pyspark.sql.functions import udf
from pyspark.sql.types import StringType

spark = SparkSession.builder.appName("UDFExample").getOrCreate()

data = [("surabhi",24),("glory",22),("dany",65),("dhanraj",23),("chintuChaitu",10)]
column = ['name','age']

df = spark.createDataFrame(data,column)
print(df.show())

def age_group(age):
  if age < 18:
    return "minor"
  elif age >=18 and age < 60:
    return "adult"
  else:
    return "senior"

age_group_udf = udf(age_group, StringType())
df_with_group = df.withColumn("age_group", age_group_udf(df.age))
df_with_group.show()

age_group_counts = df_with_group.groupBy("age_group").count()
age_group_counts.show()



`;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
    function copyMultilineText7() {
      // Your variable containing multiline text data
      var yourMultilineVariable = ` 
      
from pyspark.sql import SparkSession
from pyspark.ml.feature import VectorAssembler
from pyspark.ml.regression import LinearRegression

spark = SparkSession.builder.appName("LinearRegressionExample").getOrCreate()

data = [(1,100),(2,110),(3,120),(4,130),(5,105)]
column = ['feature','target']

df = spark.createDataFrame(data,column)
df.show()

assembler = VectorAssembler(inputCols=['feature'], outputCol="features")
assembler_df = assembler.transform(df).select('features','target')

lr = LinearRegression(featuresCol='features',labelCol='target')
lr_model = lr.fit(assembler_df)
print("Coefficients:", lr_model.coefficients)
print("Intercept:", lr_model.intercept)

training_summary = lr_model.summary
print("RMSE:", training_summary.rootMeanSquaredError)
print("R-squared:", training_summary.r2)

prediction = lr_model.transform(assembler_df)
prediction.select('features','target','prediction').show()




      `;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
     function copyMultilineText8() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `

from pyspark.sql import SparkSession
from pyspark.ml.clustering import KMeans
from pyspark.ml.feature import VectorAssembler

spark = SparkSession.builder.appName("KMeansExample").getOrCreate()
data = [(1,2),(2,5),(5,8),(8,8),(4,6),(9,11)]
columns = ['subject1','subject2']
df = spark.createDataFrame(data,columns)
df.show()
assembler = VectorAssembler(inputCols=['subject1','subject2'], outputCol="features")
assemble1 = assembler.transform(df)
assemble1.show()

kmeans = KMeans(k=2,seed=1)
model = kmeans.fit(assemble1)
predictions = model.transform(assemble1)
predictions.show()

for center in model.clusterCenters():
  print(center)



`;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
    function copyMultilineText9() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `

from pyspark.sql import SparkSession
from pyspark.ml.classification import LogisticRegression
from pyspark.ml.feature import CountVectorizer,IDF,Tokenizer

spark = SparkSession.builder.appName("LogisticRegressionExample").getOrCreate()
email = [(1,'Congratulations! You have won a lottery worth $1 million. Click here to claim your prize.'),
         (0,'Hi John, can we meet tomorrow for lunch?'),
         (1,'Urgent: Your account has been hacked. Click here to recover your password.'),
         (0,'Hey, how are you doing?'),
         (1,'Congratulations! You have won a free vacation. Click here to claim your prize.')]

columns = ['label','email']
df = spark.createDataFrame(email,columns)
df.show()

token = Tokenizer(inputCol='email',outputCol='tokens')
df = token.transform(df)
df.show()

vect = CountVectorizer(inputCol="tokens",outputCol="raw features")
vect_model = vect.fit(df)
df = vect_model.transform(df)
df.show()

idf = IDF(inputCol="raw features",outputCol="features")
idf_model = idf.fit(df)
df = idf_model.transform(df)
df.show()

df = df.select('label','features')
df.show()
lr = LogisticRegression(featuresCol='features',labelCol='label')
lr_model = lr.fit(df)
predictions = lr_model.transform(df)
predictions.show()



`;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
    function copyMultilineText10() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `

from pyspark.sql import SparkSession
from pyspark.ml.classification import NaiveBayes
from pyspark.ml.evaluation import MulticlassClassificationEvaluator
from pyspark.ml.feature import VectorAssembler, StringIndexer

# Create Spark Session
spark = SparkSession.builder.appName("NaiveBayes_Weather").getOrCreate()
# Sample weather data (label = Weather Condition)
weather_data = [
    ("Rainy", 22, 85, 15),
    ("Sunny", 30, 40, 10),
    ("Cloudy", 25, 60, 12),
    ("Rainy", 18, 90, 20),
    ("Sunny", 35, 35, 8),
    ("Cloudy", 28, 55, 14),
    ("Rainy", 20, 88, 18),
    ("Sunny", 33, 38, 9),
]

columns = ["weather", "temperature", "humidity", "wind_speed"]
df = spark.createDataFrame(weather_data, columns)

# Show dataset
df.show()

indexer = StringIndexer(inputCol="weather", outputCol="label")
df_indexed = indexer.fit(df).transform(df)

df_indexed.show()

assembler = VectorAssembler(inputCols=["temperature", "humidity", "wind_speed"], outputCol="features")
df_transformed = assembler.transform(df_indexed).select("label", "features")

df_transformed.show()
train_data, test_data = df_transformed.randomSplit([0.7, 0.3], seed=42)
nb = NaiveBayes(modelType="multinomial")
model = nb.fit(train_data)
predictions = model.transform(test_data)
predictions.show()

evaluator = MulticlassClassificationEvaluator(labelCol="label", predictionCol="prediction", metricName="accuracy")
accuracy = evaluator.evaluate(predictions)

print(f"Model Accuracy: {accuracy * 100:.2f}%")

`;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
    function copyMultilineText11() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `

from pyspark.sql import SparkSession

# Initialize Spark Session
spark = SparkSession.builder.appName("WordCount").getOrCreate()
sc = spark.sparkContext  # Get the SparkContext

# Sample text data (simulating a small dataset)
data = [
    "hello world",
    "hello pyspark",
    "pyspark map reduce example",
    "reduce and map are powerful",
]

# Create an RDD (Resilient Distributed Dataset)
rdd = sc.parallelize(data)

# Map Step: Split sentences into words and assign count 1 to each
mapped_rdd = rdd.flatMap(lambda line: line.split(" ")).map(lambda word: (word, 1))

# Reduce Step: Sum up occurrences of each word
word_counts = mapped_rdd.reduceByKey(lambda a, b: a + b)

# Collect and print results
result = word_counts.collect()
for word, count in result:
    print(f"{word}: {count}")

# Stop Spark session
spark.stop()


`;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
    function copyMultilineText12() {
      // Your variable containing multiline text data
      var yourMultilineVariable = `

from pyspark.sql import SparkSession
from pyspark.sql.functions import explode, split, col

spark = SparkSession.builder.appName("WordCount").getOrCreate()

#load the sample text data
data = [("hello world",),("how are you",),("i am fine",),("surabhi",)]
df = spark.createDataFrame(data, ["text"])
df.show(truncate = False)

word_df = df.withColumn("words",explode(split(col('text')," ")))
word_df.show()

word_count = word_df.groupBy("words").count().orderBy(col("count").desc())
word_count.show()


`;

      // Assign the variable's value to the text variable
      var text = yourMultilineVariable;

      // Create a temporary textarea element to hold the text
      var tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;

      // Append the textarea element to the DOM
      document.body.appendChild(tempTextArea);

      // Select the text in the textarea
      tempTextArea.select();
      tempTextArea.setSelectionRange(0, 99999); /* For mobile devices */

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary textarea
      document.body.removeChild(tempTextArea);

      
    }
  </script>
</body>
</html>
